---
const colorSchemes = [
  { name: 'Accent Gold', light: 'rgba(139,105,20,0.8)', dark: 'rgba(201,169,97,0.8)' },
  { name: 'Ocean Blue', light: 'rgba(30,58,138,0.8)', dark: 'rgba(96,165,250,0.8)' },
  { name: 'Forest Green', light: 'rgba(21,128,61,0.8)', dark: 'rgba(134,239,172,0.8)' },
  { name: 'Rose Pink', light: 'rgba(190,18,60,0.8)', dark: 'rgba(251,113,133,0.8)' },
  { name: 'Purple Haze', light: 'rgba(109,40,217,0.8)', dark: 'rgba(192,132,252,0.8)' },
];
---

<div class="relative">
  <button 
    id="color-picker-toggle" 
    class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-800 transition-colors text-gray-800 dark:text-gray-200" 
    aria-label="Choose Colors"
    title="Background Colors"
  >
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
    </svg>
  </button>

  <div 
    id="color-picker-dropdown" 
    class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg overflow-hidden z-50"
  >
    <div class="p-2">
      <div class="text-xs font-semibold text-gray-500 dark:text-gray-400 px-2 py-1">Background Color</div>
      {colorSchemes.map(scheme => (
        <button
          class="color-scheme-option w-full px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-800 rounded flex items-center gap-2 transition-colors"
          data-scheme={scheme.name}
          data-light={scheme.light}
          data-dark={scheme.dark}
        >
          <div class="w-4 h-4 rounded-full border border-gray-300 dark:border-gray-600" style={`background: linear-gradient(135deg, ${scheme.light} 0%, ${scheme.dark} 100%)`}></div>
          <span>{scheme.name}</span>
        </button>
      ))}
    </div>
  </div>
</div>

<script>
  const toggle = document.getElementById('color-picker-toggle');
  const dropdown = document.getElementById('color-picker-dropdown');
  const options = document.querySelectorAll('.color-scheme-option');

  // Load saved color scheme
  const savedScheme = localStorage.getItem('bgColorScheme');
  if (savedScheme) {
    const scheme = JSON.parse(savedScheme);
    window.dispatchEvent(new CustomEvent('color-change', { detail: scheme }));
  }

  toggle?.addEventListener('click', (e) => {
    e.stopPropagation();
    dropdown?.classList.toggle('hidden');
  });

  // Close dropdown when clicking outside
  document.addEventListener('click', () => {
    dropdown?.classList.add('hidden');
  });

  dropdown?.addEventListener('click', (e) => {
    e.stopPropagation();
  });

  options.forEach(option => {
    option.addEventListener('click', () => {
      const scheme = {
        name: option.dataset.scheme,
        light: option.dataset.light,
        dark: option.dataset.dark
      };
      
      localStorage.setItem('bgColorScheme', JSON.stringify(scheme));
      window.dispatchEvent(new CustomEvent('color-change', { detail: scheme }));
      dropdown?.classList.add('hidden');
    });
  });
</script>
